$fieldArray = @("AccountType","Address1","Address2","Address3","APPaymentUseBankAvg","AutoBankAdjustment","AutoBankTransferCrossCurr","AutoBankTransferSameCurr","AutoCashMovement","AutoCustBalanceReceipt","AutoCustBalanceReceiptApplyAll","AutoInvoicePayment","AutoMatchStatement","AutoOnAccountReceipt","AutoRcgAPRefNum","AutoRcgAPSupplier","AutoRcgAPTranDate","AutoRcgARCustomer","AutoRcgARRefNum","AutoRcgARTranDate","AutoRcgUnknownTran","AutoRecDocuments","AutoRetrieve","AutoReverse","AutoStatementImport","BankBranchCode","BankCheckDigit","BankCompID","BankCustNum","BankIdentifier","BankName","BankRoutingNum","BankSlip","BankTranfAccountType","BankType","BKJournalCode","CDJournalCode","CHDTAID","CheckingAccount","CHISRPartyID","City","ClearBankExchRate","Closed","ClosingBalance","ClosingDate","CNSellerAddress","CNSellerBankName","COIsOneTimeBankAcct","ConsInvPmt","COOneTimeID","CorrespAccount","CountryNum","CreditorID","CRJournalCode","CurrencyCode","DebNoteOnly","DefPosPayEFTHeadUID","Description","DocLOCLimit","EFTHeadUID","EntryClassCode","ExportDecimalPoint","FilterByLine","FloatAmt","IBANCode","InvPerCheckStub","JPBankName","JPBranchName","LegalName","LName","LocalBIC","LOCLimit","LogoFont","LogoImageID","LogoText01","LogoText02","LogoText03","LogoText04","LogoText05","LogoText06","LogoType","MatchTolerance","MsgIDCounter","MXSATCode","MXSATNameFull","MXSATNameShort","NextPINum","NumPIDigits","OpeningBalance","OpeningDate","ParamCode","PayerRef","PayrollCheckingAccount","PeriodThreshold","POBankAcctNum","PositivePayBatchID","PositivePayRemoteID","PostalCode","PRAlignTax","PreprintedCheckNum","PRJournalCode","PRLinePerPRCheck","PRPreprintedCheckNumber","RBankNum","RBranchNum","RecBalFiscalPeriod","RecBalFiscalYear","RecBalFiscalYearSuffix","ReconciledBalance","ReconcileOtherBalances","RevalueUseRecBal","Rpt1LOCLimit","Rpt2LOCLimit","Rpt3LOCLimit","ServClassCode","SignatureFont","SignatureImageID","SignatureText01","SignatureText02","SignatureText03","SignatureText04","SignatureText05","SignatureText06","SignatureType","State","TaxPayerID","TaxRegReason","TransferPersonCode","TransferPersonName","TranTemplateID","TypeCode","UsePendAcct","AcctRefNumber","AcrossNatAcc","AddlHdlgFlag","AddressVal","AEPLOQType","AGAFIPResponsibilityCode","AGBillToProvinceCode","AGGrossIncomeTaxID","AGIDDocTypeCode","AGIDDocumentNumber","AgingCreditClearDate","AgingCreditClearUserID","AgingCreditCode","AgingCreditHold","AgingCreditHoldDate","AgingCreditHoldSource","AGProvinceCode","AGUseGoodDefaultMark","AllocPriorityCode","AllowAltBillTo","AllowAsAltRemitTo","AllowOTS","AllowShipTo3","AnnualRevenue","ApplyChrg","ARInvoiceAdjITCode","ARInvoiceITCode","BillDay","BillFrequency","BorderCrossing","BTAddress1","BTAddress2","BTAddress3","BTCity","BTCountry","BTCountryNum","BTFaxNum","BTFormatStr","BTName","BTPhoneNum","BTState","BTZip","BusinessCust","CertOfOrigin","ChangeDate","ChangedBy","ChangeTime","ChargeCode","CheckConfirmCapPromise","CheckDateCapPromise","CheckDuplicatePO","CheckUpdateCapPromise","ChrgAmount","COD","CODAmount","CODCheck","CODFreight","COIsOneTimeCust","Collections","CollectionsDate","CommercialInvoice","ConsolidateLinesPerPart","ConsolidateSO","ContBillDay","Country","CreditCardOrder","CreditClearDate","CreditClearTime","CreditClearUserID","CreditHold","CreditHoldDate","CreditHoldSource","CreditIncludeOrders","CreditIncludePI","CreditLimit","CreditMemoITCode","CreditReviewDate","CSR","CustID","CustomerType","CustPartOpts","CustPILimit","CustPricingSchema","CustURL","DateCollectionPosted","DeclaredAmt","DeclaredIns","DefaultFOB","DefaultInvoicestyle","DefaultLOQstyle","DefaultOrderAcknowledgement","DefaultOversPricing","DefaultPackSlip","DeferredRev","DeliveryConf","DeliveryType","DemandAddAction","DemandAddLeadTime","DemandCancelAction","DemandCancelLeadTime","DemandCapPromiseAction","DemandCapPromiseDate","DemandCapPromiseUpdate","DemandChangeAction","DemandChangeDateAction","DemandChangeDateLeadTime","DemandChangeLeadTime","DemandCheckCfgAction","DemandCheckConfig","DemandCheckCUMM","DemandCheckCUMMAction","DemandCheckForPart","DemandCheckForPartAction","DemandCheckForRev","DemandCheckForRevAction","DemandCheckForRunOutPart","DemandCheckForRunOutPartAction","DemandCloseNoMatch","DemandCloseRejSkd","DemandDateType","DemandDeliveryDays","DemandNewLineAction","DemandNewLineLeadTime","DemandPricing","DemandQtyChangeAction","DemandQtyChangeLeadTime","DemandSplitSched","DemandUnitPriceDiff","DemandUnitPriceDiffAction","DEOrgType","DirectDebiting","DiscountPercent","DiscountQualifier","DmdCheckPartialShip","DmdCheckShipAction","DocGlobalCreditLimit","DocGlobalPILimit","DocOnly","DueDateCriteria","EAddress","EarlyBuffer","ECCType","EDICode","EInvCompanyIDAttr","EInvoice","EMailAddress","EntityUseCode","ERSOrder","EstDate","ETCAddrChg","ExcFromVal","ExternalCRMCustomerID","ExternalCRMCustomerType","ExternalCRMLastSync","ExternalCRMSyncRequired","ExternalDeliveryNote","ExternalID","ExtID","FaxNum","FederalID","FFAddress1","FFAddress2","FFAddress3","FFCity","FFCompName","FFContact","FFCountry","FFCountryNum","FFID","FFPhoneNum","FFState","FFZip","FinCharges","FormatStr","GlbNACreditIsShare","GlbNACreditSharedPrc","GlbNAParentCreditIsUsed","GlbNAParentCreditPrc","GlobalCredIncOrd","GlobalCredIncPI","GlobalCreditHold","GlobalCreditLimit","GlobalCurrencyCode","GlobalCust","GlobalLock","GlobalPILimit","GroundType","GroupCode","HasBank","Hazmat","ICCust","ICTrader","ImporterOfRecord","INCSTNumber","IndividualPackIDs","Industry","INGSTComplianceRate","INPANNumber","INTaxRegistrationID","IntrntlShip","InvcOrderCmpDflt","InvPerPackLine","LangNameID","LateBuffer","LetterOfInstr","LinkPortNum","LOQBookCaFinishing","LOQBookCapaper","LOQBookCaPress","LOQBookCatPlates","LOQBookPCFinishing","LOQBookPCPaper","LOQBookPCPlates","LOQBookPCPress","LOQPrepressStyle","LOQVariations","ManagedVendID","ManagedVendNum","MarkUpID","MiscCashRecITCode","MXAccountNumber","MXCURP","MXGeneralPublic","MXMunicipio","MXPurchaseType","MYIndustryCode","NACreditIsShare","NACreditPreferenceList","NACreditSharedPrc","Name","NAParentCreditIsUsed","NAParentCreditPrc","NARlsClassCode","NoContact","NonStdPkg","NotifyEMail","NotifyFlag","NumberOfEmployees","OneInvPerPS","OrderHoldForReview","OrgRegCode","OTSmartString","OTSSaveAs","OurBankCode","OurSupplierCode","OverrideRlsClass","OversPct","Ownership","ParentCustNum","PBTerms","PEAddressID","PECollectionAgent","PEDocumentID","PEGoodsContributor","PEGuaranteeAddress1","PEGuaranteeAddress2","PEGuaranteeAddress3","PEGuaranteeCity","PEGuaranteeCountry","PEGuaranteeName","PEGuaranteePhoneNum","PEGuaranteeState","PEGuaranteeTaxID","PEGuaranteeZip","PEIdentityDocType","PendingTerritoryID","PENoAddress","PENotFound","PEPerceptionRegime","PeriodicBilling","PeriodicityCode","PEWithholdAgent","PhoneNum","PMUID","PreferredBank","PriceTolerance","PrimBCon","PrimPCon","PrimSCon","PrintAck","PrintLabels","PrintStatements","RACode","Rating","RebateForm","RebateVendorNum","RefNotes","RegistrationCode","ReminderCode","ResaleID","ResDelivery","ReservePriorityCode","RfqAttachAllow","SalesRepCode","SatDelivery","SatPickup","SendToFSA","ServAlert","ServAuthNum","ServDeliveryDate","ServHomeDel","ServInstruct","ServPhone","ServRef1","ServRef2","ServRef3","ServRef4","ServRef5","ServRelease","ServSignature","ShipExprtDeclartn","ShippingQualifier","ShipToNum","ShipToTerrList","ShipViaCode","SyncToExternalCRM","TaxAuthorityCode","TaxEntityType","TaxExempt","TaxMethod","TaxRegionCode","TaxRoundRule","TermsCode","TerritoryID","TerritoryLock","THBranchID","ThirdPLCust","TickerLocation","TickerSymbol","TradingPartnerName","TWDeductGUIFormatCode","TWGUIRegNum","TWTaxPayerType","UndersPct","UPSQuantumView","UPSQVEmailType","UPSQVMemo","UPSQVShipFromName","ValidPayer","ValidShipTo","ValidSoldTo","Variations","WebCustomer","WIApplication","WICustomer","WIShippingCosts","Zip","AccountNum","AccountRef","AdvTaxInv","AGApartment","AGExtraStreetNumber","AGFloor","AGIDDocumentTypeCode","AGLocationCode","AGNeighborhood","AGStreet","AGStreetNumber","APInvoiceAdjITCode","APInvoiceITCode","Approved","CalendarID","Code1099ID","COIsOneTimeVend","ConsolidatedPurchasing","CPay","DebitMemoITCode","ElecPayment","ExternalPurchasing","FATCA","FormTypeID","GlobalVendor","ICVend","Inactive","INSupplierType","LocalPurchasing","ManagedCust","ManagedCustID","ManagedCustNum","MaxLateDaysPORel","MinOrderValue","MiscPayITCode","MXRetentionCode","MXTARCode","NameControl","NoBankingReference","NonUS","OneCheck","OnTimeRating","PayHold","PaymentReporting","PERetentionRegime","PLAutomaticAPInvoiceNum","PmtAcctRef","PriceRating","PrimaryBankID","Print1099","PurPoint","QualityRating","RcvInspectionReq","Reporting1099Name","Reporting1099Name2","RevChargeMethod","SecondTINNotice","ServiceRating","TIN","TINType","TINValidationStatus","VendorID","VendPILimit","VendURL","WebVendor","","","","AllowDraftCI","AllowDraftCR","AllowNegBal","CashPayMethodName","CashPayMethodPMUID","DayCloseMode","DocInitPayrollBal","DocInitTotalBal","EntrustedCashier","EntrustedFrom","EntrustedTill","InitPayrollBal","InitTotalBal","LimitExptPayroll","LimitTotal","Location","OpenedFrom","PostingOpt","PrintLastPage","PrintPerPage","RateGrpCode","ReportTranDocType","Rpt1InitPayrollBal","Rpt1InitTotalBal","Rpt2InitPayrollBal","Rpt2InitTotalBal","Rpt3InitPayrollBal","Rpt3InitTotalBal","UseExtnNumForCI","UseExtnNumForCR","Address","AllowDirLbr","AllowIndirect","AllowProduction","AllowProject","AllowService","AllowSetup","CanEnterIndirectTime","CanEnterProductionTime","CanEnterProjectTime","CanEnterServiceTime","CanEnterSetupTime","CanOverrideAllocations","CanOverrideJob","CanReportNCQty","CanReportQty","CanReportScrapQty","CanRequestMaterial","CnvEmpID","ContractEmp","DcdUserID","DefaultClaimCurrencyCode","DefaultExpCurrencyCode","DefaultExpenseCode","DefaultIndirectCode","DefaultLaborHrs","DefaultLaborTypePseudo","DefaultPMUID","DefaultResourceGrpID","DefaultResourceID","DefaultTaxIncluded","DefaultTaxRegionCode","DefaultTimeTypCd","DisallowTimeEntry","EmgContact","EmgPhone","EmpID","EmpStatus","ExpenseAdvReqAllowed","ExpenseAdvReqAutoApprove","ExpenseAdvReqWFGroupID","ExpenseAutoApprove","ExpenseCode","ExpenseEntryAllowed","ExpenseVendorNum","ExpenseWFGroupID","ExternalMES","ExternalMESLastSync","ExternalMESSyncRequired","FirstName","ImageID","JCDept","LaborRate","LastName","MaterialHandler","MiddleInitial","MobileResourceID","MobileUserPassword","Payroll","PayrollValuesForHCM","PerConID","PermitAttributeSqc","PermitCalibration","PermitCavities","PermitDown","PermitHelp","PermitJobControl","PermitLanguage","PermitMachinePm","PermitManualSqc","PermitMaterialLot","PermitNextJobControl","PermitPercentRegrind","PermitPreferences","PermitSaveProfile","PermitScrap","PermitSetupMaterial","PermitToolPm","PermitVariableSqc","Phone","PhotoFile","PkgInboundAllowed","PkgInventoryAllowed","PkgManufacturingAllowed","PkgMasterMixedPrint","PkgOutboundAllowed","PkgQualityAllowed","PkgSuppressPrintMessages","ProductionWorker","PRSetupReq","ResourceGrpID","ResourceID","ServTech","Shift","ShipRecv","ShopSupervisor","SupervisorID","SyncAddressToPerCon","SyncEmailToPerCon","SyncNameToPerCon","SyncPhoneToPerCon","TimeAutoApprove","TimeWFGroupID","UserNameInJDF","WarehouseManager","","CheckNum","CreditAmount","DebitAmount","GLAccountasDrGLAccount","SourceModule")
[boolean]$remove = $true
[string]$file = "C:\_projects\ERP10Releases\10.2.200\Current\Extensibility\CSF\Russia\Deployment\SSRS\reports\RU\PettyCashIssues\PettyCashIssues.rdl"
[System.Xml.XmlDocument] $document = New-Object System.Xml.XmlDocument
$document.load($file)
Write-Host $fieldArray.Length
foreach ($field in $fieldArray){
    if($field -ne ""){
        #Write-Host "$field :"
        $found_elements1 = $document.selectnodes("//*[local-name()='Field' and @Name='$field']")
        [int]$fieldCnt = $found_elements1.count;
    
        $found_elements2 = $document.selectnodes("//*[local-name()='Value' and contains(text(),'$field')]")
        [int]$usingCnt = $found_elements2.count;
        if($usingCnt -ne 0){
            Write-Host $field
            Write-Host $usingCnt
            Write-Host $found_elements2.InnerText
            Write-Host "------------------------"
        } elseif($remove){
           foreach($node in $found_elements1){
               $node.ParentNode.RemoveChild($node)
           }
        }
    }
}
if($remove){
  $document.Save($file + ".new.xml")
}
Write-Host "Done!"
